<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barkley</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="page-wrapper">
        <!-- Knowledge Graph Background (always visible) -->
        <div class="knowledge-graph">
            <svg id="graph-svg"></svg>
        </div>

        <!-- Hero Animation Container -->
        <div id="hero-container" class="hero-container">
            <div class="hero-text">
                <span class="letter" data-letter="b">b</span>
                <span class="letter" data-letter="a">a</span>
                <span class="letter" data-letter="r">r</span>
                <span class="letter" data-letter="k">k</span>
                <span class="letter" data-letter="l">l</span>
                <span class="letter" data-letter="e">e</span>
                <span class="letter" data-letter="y">y</span>
            </div>
        </div>
    </div>

    <!-- Main Content (hidden initially) -->
    <div id="main-content" class="main-content hidden">
        <header class="header">
            <nav class="nav">
                    <ul class="nav-links">
                        <li><a href="about.html">Sectors</a></li>
                        <li><a href="services.html">Capabilities</a></li>
                        <li><a href="portfolio.html">Platform</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li><a href="blog.html">Social</a></li>
                    </ul>
            </nav>
        </header>

        <main class="main">
            <!-- Knowledge Section -->
            <section class="data-section">
                <h2>KNOWLEDGE</h2>
                <div class="data-columns">
                    <div class="data-column left-column">
                        <p>Data is exhaust. Knowledge is leverage.</p>
                            <p>Barkley enables organisations to continousouly map, navigate, predict and react to knowledge as it evolves.</p>
                        <p>Domain-fluent AIs work beside our Forward-Deployed Engineers to surface, structure, and use knowledge at scale — converting operational noise into compound efficiency.</p>
                    </div>
                    <div class="data-column right-column">
                        <p>As domains evolve, the system learns and adapts in real time — wiring insight directly into process, compliance, and decision.</p>
                        <p>The result: knowledge that executes, decisions that move faster, cost less, and stay aligned.</p>
                        <p>Replace bureaucracy with intelligence, and pull efficiency forward by orders of magnitude. This capability is <strong>Barkley</strong>.</p>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Grey Navigation Section -->
        <section class="grey-nav-section">
            <div class="grey-nav-container">
                <div class="data-columns">
                    <div class="data-column left-column">
                        <h3>Capabilities</h3>
                        <div class="capabilities-links">
                            <a href="#">Data Processing Platform</a>
                            <a href="#">AI & Machine Learning</a>
                            <a href="#">FDE</a>
                            <a href="#">Domain Fluency</a>
                            <a href="#">Knowledge Management</a>
                            <a href="#">Process Automation</a>
                        </div>
                    </div>
                    <div class="data-column right-column">
                        <!-- Empty right column to match Knowledge section structure -->
                    </div>
                </div>
                
                <!-- Site Map Section -->
                <div class="data-columns">
                    <div class="data-column left-column">
                        <div class="site-map-section">
                            <h3>Site Map</h3>
                                <div class="site-map-links">
                                    <a href="about.html">Sectors</a>
                                    <a href="services.html">Capabilities</a>
                                    <a href="portfolio.html">Platform</a>
                                    <a href="contact.html">Contact</a>
                                    <a href="blog.html">Social</a>
                                </div>
                        </div>
                    </div>
                    <div class="data-column right-column">
                        <div class="disclaimer-section">
                            <p>Copyright 2025 Barkley. All rights reserved.</p>
                            <p><a href="#">Terms of Use</a> | <a href="#">Privacy & Cookies</a></p>
                            <p><a href="#">Intellectual Property Guidelines</a> | <a href="#">UK Modern Slavery Act</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
      (function () {
        function hasHeroCirclesParam() {
          try {
            const params = new URLSearchParams(window.location.search);
            return params.get('hero') === 'circles';
          } catch (_) { return false; }
        }

        // Classic path: load golden source synchronously during parse
        function loadGolden() {
          try {
            document.write('\u003Cscript src="script.js"\u003E\u003C/script\u003E');
          } catch (_) {
            // Fallback in case document.write is blocked
            var s = document.createElement('script');
            s.src = 'script.js';
            s.defer = true;
            document.head.appendChild(s);
          }
        }

        if (!hasHeroCirclesParam()) {
          loadGolden();
          return;
        }

        // Opt-in path: dynamically import reusable animation module
        // Requires D3 to already be loaded globally (as in <head>)
        import('./animations/hero-circles.js')
          .then(mod => {
            const ctrl = mod.initHeroCircles({
              svgId: 'graph-svg',
              containerSelector: '.knowledge-graph',
              anchorSelector: '.hero-text'
            });

            // Apply enhanced color to KNOWLEDGE and bold Barkley (parity with golden source)
            if (ctrl && ctrl.enhancedColor) {
              const knowledgeTitle = document.querySelector('.data-section h2');
              if (knowledgeTitle) knowledgeTitle.style.color = ctrl.enhancedColor;
              const barkleyStrong = document.querySelector('.data-column.right-column strong');
              if (barkleyStrong) barkleyStrong.style.color = ctrl.enhancedColor;
            }

            // Reveal main content similarly to golden script
            var main = document.getElementById('main-content');
            if (main) main.classList.remove('hidden');

            // Hero text color alternation once per carousel cycle (approximate parity)
            (function setupHeroCycle(){
              const svgEl = document.getElementById('graph-svg');
              const containerEl = document.querySelector('.knowledge-graph');
              if (!svgEl) return;
              const getCycleWidth = () => {
                const cw = containerEl && containerEl.clientWidth || 0;
                if (cw > 0) return cw;
                const sw = svgEl.getBoundingClientRect().width || 0;
                return sw || window.innerWidth;
              };
              const width = getCycleWidth(); // compute once
              const baseCarouselSpeed = 0.2625;
              const totalDistance = width + 200 + 150;
              const cycleTimeMs = (totalDistance / baseCarouselSpeed) * 16.67 * 0.6;
              let lastHeroCycle = 0;
              let heroAnimationTime = 0;
              function tick(){
                heroAnimationTime += 16.67;
                const currentCycle = Math.floor(heroAnimationTime / cycleTimeMs);
                if (currentCycle > lastHeroCycle) {
                  lastHeroCycle = currentCycle;
                  const letters = document.querySelectorAll('.letter');
                  if (lastHeroCycle % 2 === 0) {
                    letters.forEach(letter => {
                      letter.style.transition = 'color 1.5s ease-out';
                      letter.style.color = '#ffffff';
                      letter.style.animation = 'none';
                    });
                  } else {
                    const map = { b:'#87CEEB', a:'#4682B4', r:'#1E90FF', k:'#000080', l:'#DC143C', e:'#FF4500', y:'#FF8C00' };
                    letters.forEach(letter => {
                      const key = letter.getAttribute('data-letter');
                      const color = map[key];
                      if (color) {
                        letter.style.transition = 'color 1.5s ease-out';
                        letter.style.color = color;
                      }
                    });
                  }
                }
                window.requestAnimationFrame(tick);
              }
              window.requestAnimationFrame(tick);
            })();
          })
          .catch(err => {
            console.error('Falling back to golden source due to error loading hero-circles:', err);
            loadGolden();
          });
      })();
    </script>
</body>
</html>
